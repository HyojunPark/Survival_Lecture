<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Cox Proportional Hazard Modeling | SOC6280: Survival Analysis: Practice</title>
  <meta name="description" content="Survival handbook" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Cox Proportional Hazard Modeling | SOC6280: Survival Analysis: Practice" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Survival handbook" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Cox Proportional Hazard Modeling | SOC6280: Survival Analysis: Practice" />
  
  <meta name="twitter:description" content="Survival handbook" />
  

<meta name="author" content="Hyojun Park" />


<meta name="date" content="2023-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="survival-models-specification-estimation-and-interpretation.html"/>
<link rel="next" href="accounting-for-heterogeneity.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.0/leaflet.js"></script>
<script src="libs/leaflet-providers-1.13.0/leaflet-providers_1.13.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.0/leaflet-providers-plugin.js"></script>
<script src="libs/Leaflet.Sync-0.0.5/L.Map.Sync.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.29/datatables.js"></script>
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Survival Analysis Workbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="bias-assessment.html"><a href="bias-assessment.html"><i class="fa fa-check"></i><b>2</b> Bias assessment</a>
<ul>
<li class="chapter" data-level="2.1" data-path="bias-assessment.html"><a href="bias-assessment.html#bias-due-to-omitted-confounders"><i class="fa fa-check"></i><b>2.1</b> Bias due to omitted confounders</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="bias-assessment.html"><a href="bias-assessment.html#gold-standard"><i class="fa fa-check"></i><b>2.1.1</b> Gold standard</a></li>
<li class="chapter" data-level="2.1.2" data-path="bias-assessment.html"><a href="bias-assessment.html#misspecified-model-a-confounder-c-was-omitted-from-the-model"><i class="fa fa-check"></i><b>2.1.2</b> Misspecified model: a confounder, <span class="math inline">\(C\)</span>, was omitted from the model</a></li>
<li class="chapter" data-level="2.1.3" data-path="bias-assessment.html"><a href="bias-assessment.html#bias-away-from-or-towards-to-the-null"><i class="fa fa-check"></i><b>2.1.3</b> Bias “away from” or “towards to” the null?</a></li>
<li class="chapter" data-level="2.1.4" data-path="bias-assessment.html"><a href="bias-assessment.html#a-c-is-not-a-confounder-on-x-and-y"><i class="fa fa-check"></i><b>2.1.4</b> A <span class="math inline">\(C\)</span> is not a confounder on <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span></a></li>
<li class="chapter" data-level="2.1.5" data-path="bias-assessment.html"><a href="bias-assessment.html#correct-model-specification-without-c"><i class="fa fa-check"></i><b>2.1.5</b> Correct model specification: Without <span class="math inline">\(C\)</span></a></li>
<li class="chapter" data-level="2.1.6" data-path="bias-assessment.html"><a href="bias-assessment.html#misspecified-model-with-c"><i class="fa fa-check"></i><b>2.1.6</b> Misspecified model with <span class="math inline">\(C\)</span></a></li>
<li class="chapter" data-level="2.1.7" data-path="bias-assessment.html"><a href="bias-assessment.html#a-c-is-a-colloder-on-x-and-y"><i class="fa fa-check"></i><b>2.1.7</b> A <span class="math inline">\(C\)</span> is a colloder on <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span></a></li>
<li class="chapter" data-level="2.1.8" data-path="bias-assessment.html"><a href="bias-assessment.html#correct-model-specification-without-c-1"><i class="fa fa-check"></i><b>2.1.8</b> Correct model specification: Without <span class="math inline">\(C\)</span></a></li>
<li class="chapter" data-level="2.1.9" data-path="bias-assessment.html"><a href="bias-assessment.html#misspecified-model-with-c-1"><i class="fa fa-check"></i><b>2.1.9</b> Misspecified model with <span class="math inline">\(C\)</span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="bias-assessment.html"><a href="bias-assessment.html#overadjustment-bias"><i class="fa fa-check"></i><b>2.2</b> Overadjustment bias</a></li>
<li class="chapter" data-level="2.3" data-path="bias-assessment.html"><a href="bias-assessment.html#total-effect"><i class="fa fa-check"></i><b>2.3</b> Total effect</a></li>
<li class="chapter" data-level="2.4" data-path="bias-assessment.html"><a href="bias-assessment.html#overadjustment"><i class="fa fa-check"></i><b>2.4</b> Overadjustment</a></li>
<li class="chapter" data-level="2.5" data-path="bias-assessment.html"><a href="bias-assessment.html#logistic-models"><i class="fa fa-check"></i><b>2.5</b> Logistic models</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="bias-assessment.html"><a href="bias-assessment.html#sex-as-a-confounder-c"><i class="fa fa-check"></i><b>2.5.1</b> Sex as a Confounder, <span class="math inline">\(C\)</span></a></li>
<li class="chapter" data-level="2.5.2" data-path="bias-assessment.html"><a href="bias-assessment.html#sex-as-a-moderator-m"><i class="fa fa-check"></i><b>2.5.2</b> Sex as a Moderator, <span class="math inline">\(M\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html"><i class="fa fa-check"></i><b>3</b> Survival Analyses: Introduction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#set-packages-and-library"><i class="fa fa-check"></i><b>3.1</b> Set packages and library</a></li>
<li class="chapter" data-level="3.2" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#dataset"><i class="fa fa-check"></i><b>3.2</b> dataset</a></li>
<li class="chapter" data-level="3.3" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#nonparametric-estimation"><i class="fa fa-check"></i><b>3.3</b> Nonparametric estimation</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#data-for-nonparametric-models"><i class="fa fa-check"></i><b>3.3.1</b> Data for nonparametric models</a></li>
<li class="chapter" data-level="3.3.2" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#kaplan-meier-estimator"><i class="fa fa-check"></i><b>3.3.2</b> Kaplan-Meier estimator</a></li>
<li class="chapter" data-level="3.3.3" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#nelson-aalen-estimator"><i class="fa fa-check"></i><b>3.3.3</b> Nelson-Aalen estimator</a></li>
<li class="chapter" data-level="3.3.4" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#comparisons-by-groups"><i class="fa fa-check"></i><b>3.3.4</b> Comparisons by groups</a></li>
<li class="chapter" data-level="3.3.5" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#better-km-figures"><i class="fa fa-check"></i><b>3.3.5</b> Better KM figures</a></li>
<li class="chapter" data-level="3.3.6" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#nonparametric-models-using-a-child-dataset-from-eha"><i class="fa fa-check"></i><b>3.3.6</b> Nonparametric models using a <span class="math inline">\(child\)</span> dataset from eha</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#proportional-hazards-and-cox-regression"><i class="fa fa-check"></i><b>3.4</b> Proportional Hazards and Cox Regression</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#a-visual-check-for-a-proportionality-assumption"><i class="fa fa-check"></i><b>3.4.1</b> A visual check for a proportionality assumption</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#parametric-estimation"><i class="fa fa-check"></i><b>3.5</b> Parametric estimation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#weibull-model"><i class="fa fa-check"></i><b>3.5.1</b> Weibull model</a></li>
<li class="chapter" data-level="3.5.2" data-path="survival-analyses-introduction.html"><a href="survival-analyses-introduction.html#gompertz-model"><i class="fa fa-check"></i><b>3.5.2</b> Gompertz model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="counting-process.html"><a href="counting-process.html"><i class="fa fa-check"></i><b>4</b> Counting Process</a>
<ul>
<li class="chapter" data-level="4.1" data-path="counting-process.html"><a href="counting-process.html#set-packages-and-library-1"><i class="fa fa-check"></i><b>4.1</b> Set packages and library</a></li>
<li class="chapter" data-level="4.2" data-path="counting-process.html"><a href="counting-process.html#example"><i class="fa fa-check"></i><b>4.2</b> Example</a></li>
<li class="chapter" data-level="4.3" data-path="counting-process.html"><a href="counting-process.html#practice-addhealth-public-datasets"><i class="fa fa-check"></i><b>4.3</b> Practice: AddHealth Public datasets</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="counting-process.html"><a href="counting-process.html#generate-a-complete-framework-with-aid-and-wave-optional"><i class="fa fa-check"></i><b>4.3.1</b> Generate a complete framework with <em>AID</em> and <em>wave</em> (Optional)</a></li>
<li class="chapter" data-level="4.3.2" data-path="counting-process.html"><a href="counting-process.html#time-variant-variables-from-each-wave"><i class="fa fa-check"></i><b>4.3.2</b> Time-variant variables from each wave</a></li>
<li class="chapter" data-level="4.3.3" data-path="counting-process.html"><a href="counting-process.html#time-invariant"><i class="fa fa-check"></i><b>4.3.3</b> Time-invariant</a></li>
<li class="chapter" data-level="4.3.4" data-path="counting-process.html"><a href="counting-process.html#merging-datasets"><i class="fa fa-check"></i><b>4.3.4</b> Merging datasets</a></li>
<li class="chapter" data-level="4.3.5" data-path="counting-process.html"><a href="counting-process.html#define-event-enter-and-exit"><i class="fa fa-check"></i><b>4.3.5</b> Define <em>event</em>, <em>enter</em>, and <em>exit</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html"><i class="fa fa-check"></i><b>5</b> Survival models: specification, estimation, and interpretation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#nonparametric-models"><i class="fa fa-check"></i><b>5.1</b> Nonparametric models</a></li>
<li class="chapter" data-level="5.2" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#semi-parametric-models-cox-regression"><i class="fa fa-check"></i><b>5.2</b> Semi-parametric models: Cox Regression</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#model-specification"><i class="fa fa-check"></i><b>5.2.1</b> Model specification</a></li>
<li class="chapter" data-level="5.2.2" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#estimation"><i class="fa fa-check"></i><b>5.2.2</b> Estimation</a></li>
<li class="chapter" data-level="5.2.3" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#interpretations"><i class="fa fa-check"></i><b>5.2.3</b> Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#logistic-regression"><i class="fa fa-check"></i><b>5.3</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#model-specification-1"><i class="fa fa-check"></i><b>5.3.1</b> Model specification</a></li>
<li class="chapter" data-level="5.3.2" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#estimation-1"><i class="fa fa-check"></i><b>5.3.2</b> Estimation</a></li>
<li class="chapter" data-level="5.3.3" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#interpretation"><i class="fa fa-check"></i><b>5.3.3</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#linear-regression"><i class="fa fa-check"></i><b>5.4</b> Linear regression</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#model-specification-2"><i class="fa fa-check"></i><b>5.4.1</b> Model specification</a></li>
<li class="chapter" data-level="5.4.2" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#estimation-2"><i class="fa fa-check"></i><b>5.4.2</b> Estimation</a></li>
<li class="chapter" data-level="5.4.3" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#interpretation-1"><i class="fa fa-check"></i><b>5.4.3</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#weibull-model-1"><i class="fa fa-check"></i><b>5.5</b> Weibull model</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#model-specification-3"><i class="fa fa-check"></i><b>5.5.1</b> Model specification</a></li>
<li class="chapter" data-level="5.5.2" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#estimation-3"><i class="fa fa-check"></i><b>5.5.2</b> Estimation</a></li>
<li class="chapter" data-level="5.5.3" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#interpretations-1"><i class="fa fa-check"></i><b>5.5.3</b> Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#exponential-model"><i class="fa fa-check"></i><b>5.6</b> Exponential model</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#model-specification-4"><i class="fa fa-check"></i><b>5.6.1</b> Model specification</a></li>
<li class="chapter" data-level="5.6.2" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#estimation-4"><i class="fa fa-check"></i><b>5.6.2</b> Estimation</a></li>
<li class="chapter" data-level="5.6.3" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#interpretations-2"><i class="fa fa-check"></i><b>5.6.3</b> Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#gompertz-model-1"><i class="fa fa-check"></i><b>5.7</b> Gompertz model</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#model-specification-5"><i class="fa fa-check"></i><b>5.7.1</b> Model specification</a></li>
<li class="chapter" data-level="5.7.2" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#estimation-5"><i class="fa fa-check"></i><b>5.7.2</b> Estimation</a></li>
<li class="chapter" data-level="5.7.3" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#interpretations-3"><i class="fa fa-check"></i><b>5.7.3</b> Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="survival-models-specification-estimation-and-interpretation.html"><a href="survival-models-specification-estimation-and-interpretation.html#graphs"><i class="fa fa-check"></i><b>5.8</b> Graphs</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html"><i class="fa fa-check"></i><b>6</b> Cox Proportional Hazard Modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#setup-working-datasets"><i class="fa fa-check"></i><b>6.1</b> Setup working datasets</a></li>
<li class="chapter" data-level="6.2" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#cox-proportional-hazard-models-example"><i class="fa fa-check"></i><b>6.2</b> Cox Proportional Hazard Models: Example</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#cox-model-specification"><i class="fa fa-check"></i><b>6.2.1</b> Cox model specification</a></li>
<li class="chapter" data-level="6.2.2" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#model-1-no-covariates"><i class="fa fa-check"></i><b>6.2.2</b> Model 1: No covariates</a></li>
<li class="chapter" data-level="6.2.3" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#model-2-categorical-covariate-region"><i class="fa fa-check"></i><b>6.2.3</b> Model 2: Categorical covariate: region</a></li>
<li class="chapter" data-level="6.2.4" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#model-3-continuous-covariate-imr.birth"><i class="fa fa-check"></i><b>6.2.4</b> Model 3: Continuous covariate: imr.birth</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#interpretation-2"><i class="fa fa-check"></i><b>6.3</b> Interpretation</a></li>
<li class="chapter" data-level="6.4" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#proportional-hazard-ph-assumption"><i class="fa fa-check"></i><b>6.4</b> Proportional hazard (PH) assumption</a></li>
<li class="chapter" data-level="6.5" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#extended-cox-model"><i class="fa fa-check"></i><b>6.5</b> Extended Cox model</a></li>
<li class="chapter" data-level="6.6" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#evaluating-the-proportional-hazard-ph-assumption"><i class="fa fa-check"></i><b>6.6</b> Evaluating the Proportional hazard (PH) assumption</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#graphical-evaluation"><i class="fa fa-check"></i><b>6.6.1</b> Graphical evaluation</a></li>
<li class="chapter" data-level="6.6.2" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#goodness-of-fit-gof"><i class="fa fa-check"></i><b>6.6.2</b> Goodness-of-fit (GOF)</a></li>
<li class="chapter" data-level="6.6.3" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#time-dependent-variable-approaches"><i class="fa fa-check"></i><b>6.6.3</b> Time-dependent variable approaches</a></li>
<li class="chapter" data-level="6.6.4" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#testing-for-influential-observations"><i class="fa fa-check"></i><b>6.6.4</b> Testing for Influential Observations</a></li>
<li class="chapter" data-level="6.6.5" data-path="cox-proportional-hazard-modeling.html"><a href="cox-proportional-hazard-modeling.html#testing-for-non-linearlity"><i class="fa fa-check"></i><b>6.6.5</b> Testing for Non-linearlity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html"><i class="fa fa-check"></i><b>7</b> Accounting for Heterogeneity</a>
<ul>
<li class="chapter" data-level="7.1" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#setup-working-datasets-1"><i class="fa fa-check"></i><b>7.1</b> Setup working datasets</a></li>
<li class="chapter" data-level="7.2" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#an-introductory-example"><i class="fa fa-check"></i><b>7.2</b> An introductory Example</a></li>
<li class="chapter" data-level="7.3" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#working-with-heterogeneity"><i class="fa fa-check"></i><b>7.3</b> Working with heterogeneity</a></li>
<li class="chapter" data-level="7.4" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#stratification"><i class="fa fa-check"></i><b>7.4</b> Stratification</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#generalized-stratified-models"><i class="fa fa-check"></i><b>7.4.1</b> Generalized stratified models</a></li>
<li class="chapter" data-level="7.4.2" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#group_by-analysis-dplyr"><i class="fa fa-check"></i><b>7.4.2</b> <code>group_by</code> analysis (<code>dplyr</code>)</a></li>
<li class="chapter" data-level="7.4.3" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#strata-in-coxph"><i class="fa fa-check"></i><b>7.4.3</b> <code>strata</code> in <code>coxph</code></a></li>
<li class="chapter" data-level="7.4.4" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#strata-in-coxph-with-interaction-terms"><i class="fa fa-check"></i><b>7.4.4</b> <code>strata</code> in <code>coxph</code> with interaction terms</a></li>
<li class="chapter" data-level="7.4.5" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#weibull-ph-models-with-or-without-stratification"><i class="fa fa-check"></i><b>7.4.5</b> Weibull PH models with or without stratification</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#frailty-models"><i class="fa fa-check"></i><b>7.5</b> Frailty models</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#simple-frailty-model"><i class="fa fa-check"></i><b>7.5.1</b> Simple Frailty Model</a></li>
<li class="chapter" data-level="7.5.2" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#shared-frailty-model"><i class="fa fa-check"></i><b>7.5.2</b> Shared Frailty Model</a></li>
<li class="chapter" data-level="7.5.3" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#cox-model-specification-1"><i class="fa fa-check"></i><b>7.5.3</b> Cox model specification</a></li>
<li class="chapter" data-level="7.5.4" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#mixed-effects-cox-model-specification"><i class="fa fa-check"></i><b>7.5.4</b> Mixed effects Cox model specification</a></li>
<li class="chapter" data-level="7.5.5" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#models-without-considering-fraility"><i class="fa fa-check"></i><b>7.5.5</b> Models without considering fraility</a></li>
<li class="chapter" data-level="7.5.6" data-path="accounting-for-heterogeneity.html"><a href="accounting-for-heterogeneity.html#coxme-package-for-frailty-models"><i class="fa fa-check"></i><b>7.5.6</b> <code>coxme</code> package for frailty models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html"><i class="fa fa-check"></i><b>8</b> More Topics on Survival Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#setup-working-datasets-2"><i class="fa fa-check"></i><b>8.1</b> Setup working datasets</a></li>
<li class="chapter" data-level="8.2" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#why-we-call-cox-model-as-semi-parametric-model"><i class="fa fa-check"></i><b>8.2</b> Why we call Cox model as semi-parametric model?</a></li>
<li class="chapter" data-level="8.3" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#why-the-cox-ph-model-is-so-popular"><i class="fa fa-check"></i><b>8.3</b> Why the Cox PH model is so popular</a></li>
<li class="chapter" data-level="8.4" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#adjusted-survival-curves-using-the-cox-ph-model"><i class="fa fa-check"></i><b>8.4</b> Adjusted Survival Curves using the Cox PH model</a></li>
<li class="chapter" data-level="8.5" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#survival-model-selection"><i class="fa fa-check"></i><b>8.5</b> Survival model selection</a></li>
<li class="chapter" data-level="8.6" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#likelihood-and-partial-likelihood"><i class="fa fa-check"></i><b>8.6</b> Likelihood and partial likelihood</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#estimation-of-the-cox-ph-model-using-maximum-likelihood-ml"><i class="fa fa-check"></i><b>8.6.1</b> Estimation of the Cox PH model using Maximum likelihood (ML)</a></li>
<li class="chapter" data-level="8.6.2" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#more-about-hazard-ratio"><i class="fa fa-check"></i><b>8.6.2</b> More about Hazard ratio</a></li>
<li class="chapter" data-level="8.6.3" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>8.6.3</b> Maximum likelihood estimation</a></li>
<li class="chapter" data-level="8.6.4" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#partial-likelihood-estimation"><i class="fa fa-check"></i><b>8.6.4</b> Partial likelihood estimation</a></li>
<li class="chapter" data-level="8.6.5" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#dependence-among-the-observations"><i class="fa fa-check"></i><b>8.6.5</b> Dependence among the observations</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#tied-or-discrete-data-analysis"><i class="fa fa-check"></i><b>8.7</b> Tied or Discrete Data Analysis</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#example-recidivism-in-the-u.s."><i class="fa fa-check"></i><b>8.7.1</b> Example: Recidivism in the U.S.</a></li>
<li class="chapter" data-level="8.7.2" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#data-management"><i class="fa fa-check"></i><b>8.7.2</b> Data management</a></li>
<li class="chapter" data-level="8.7.3" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#the-treatment-of-ties"><i class="fa fa-check"></i><b>8.7.3</b> The treatment of ties</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#the-discrete-method"><i class="fa fa-check"></i><b>8.8</b> The discrete method</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="more-topics-on-survival-models.html"><a href="more-topics-on-survival-models.html#continuous-and-discrete-models"><i class="fa fa-check"></i><b>8.8.1</b> Continuous and Discrete Models</a></li>
<li><a href="more-topics-on-survival-models.html#interval-censoring" id="toc-interval-censoring"><span class="toc-section-number">8.8.2</span> Interval censoring<br />
</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="add-health-project.html"><a href="add-health-project.html"><i class="fa fa-check"></i><b>9</b> Add Health Project</a>
<ul>
<li class="chapter" data-level="9.1" data-path="add-health-project.html"><a href="add-health-project.html#library"><i class="fa fa-check"></i><b>9.1</b> Library</a></li>
<li class="chapter" data-level="9.2" data-path="add-health-project.html"><a href="add-health-project.html#access-datasets"><i class="fa fa-check"></i><b>9.2</b> Access datasets</a></li>
<li class="chapter" data-level="9.3" data-path="add-health-project.html"><a href="add-health-project.html#load-5-wave-sample"><i class="fa fa-check"></i><b>9.3</b> Load 5-wave sample</a></li>
<li class="chapter" data-level="9.4" data-path="add-health-project.html"><a href="add-health-project.html#long-form-dataset-wave-person"><i class="fa fa-check"></i><b>9.4</b> Long-form dataset (wave-person)</a></li>
<li class="chapter" data-level="9.5" data-path="add-health-project.html"><a href="add-health-project.html#exploring-variables-in-add-health"><i class="fa fa-check"></i><b>9.5</b> Exploring variables in Add Health</a></li>
<li class="chapter" data-level="9.6" data-path="add-health-project.html"><a href="add-health-project.html#outcomes-exposures-and-confounders"><i class="fa fa-check"></i><b>9.6</b> Outcomes, exposures, and confounders</a></li>
<li class="chapter" data-level="9.7" data-path="add-health-project.html"><a href="add-health-project.html#demographic-variables---time-invariant"><i class="fa fa-check"></i><b>9.7</b> Demographic variables - time-invariant</a></li>
<li class="chapter" data-level="9.8" data-path="add-health-project.html"><a href="add-health-project.html#merging-datasets-1"><i class="fa fa-check"></i><b>9.8</b> Merging datasets</a></li>
<li class="chapter" data-level="9.9" data-path="add-health-project.html"><a href="add-health-project.html#data-management-recoding-and-so-on"><i class="fa fa-check"></i><b>9.9</b> Data management, recoding, and so on</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="add-health-project.html"><a href="add-health-project.html#bmi"><i class="fa fa-check"></i><b>9.9.1</b> BMI</a></li>
<li class="chapter" data-level="9.9.2" data-path="add-health-project.html"><a href="add-health-project.html#sampling-weights"><i class="fa fa-check"></i><b>9.9.2</b> Sampling weights</a></li>
<li class="chapter" data-level="9.9.3" data-path="add-health-project.html"><a href="add-health-project.html#multiple-imputation"><i class="fa fa-check"></i><b>9.9.3</b> Multiple imputation</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="add-health-project.html"><a href="add-health-project.html#analytic-approach"><i class="fa fa-check"></i><b>9.10</b> Analytic approach</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="add-health-project.html"><a href="add-health-project.html#a-linear-regression-with-the-current-dataset"><i class="fa fa-check"></i><b>9.10.1</b> A linear regression with the current dataset</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SOC6280: Survival Analysis: Practice</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cox-proportional-hazard-modeling" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Cox Proportional Hazard Modeling<a href="cox-proportional-hazard-modeling.html#cox-proportional-hazard-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="setup-working-datasets" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Setup working datasets<a href="cox-proportional-hazard-modeling.html#setup-working-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="cox-proportional-hazard-modeling.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb161-2"><a href="cox-proportional-hazard-modeling.html#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb161-3"><a href="cox-proportional-hazard-modeling.html#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb161-4"><a href="cox-proportional-hazard-modeling.html#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eha)</span>
<span id="cb161-5"><a href="cox-proportional-hazard-modeling.html#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb161-6"><a href="cox-proportional-hazard-modeling.html#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb161-7"><a href="cox-proportional-hazard-modeling.html#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb161-8"><a href="cox-proportional-hazard-modeling.html#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb161-9"><a href="cox-proportional-hazard-modeling.html#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb161-10"><a href="cox-proportional-hazard-modeling.html#cb161-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb161-11"><a href="cox-proportional-hazard-modeling.html#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb161-12"><a href="cox-proportional-hazard-modeling.html#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coxme)</span>
<span id="cb161-13"><a href="cox-proportional-hazard-modeling.html#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="cox-proportional-hazard-modeling.html#cb162-1" aria-hidden="true" tabindex="-1"></a>oldmort01 <span class="ot">&lt;-</span> oldmort</span></code></pre></div>
</div>
<div id="cox-proportional-hazard-models-example" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Cox Proportional Hazard Models: Example<a href="cox-proportional-hazard-modeling.html#cox-proportional-hazard-models-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cox-model-specification" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Cox model specification<a href="cox-proportional-hazard-modeling.html#cox-model-specification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[h_{(t,X)} = h_0 (t) \exp(\sum_{i=1}^p \beta_i X_i), \;\; \text{where}\; X = (X_1, X_2, \cdots, X_p)\]</span></p>
<p>The following result was obtained by using <code>coxreg</code> from the <code>eha</code> package.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="cox-proportional-hazard-modeling.html#cb163-1" aria-hidden="true" tabindex="-1"></a>oldmort_cox <span class="ot">&lt;-</span> <span class="fu">coxreg</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> sex <span class="sc">+</span> region <span class="sc">+</span> imr.birth, </span>
<span id="cb163-2"><a href="cox-proportional-hazard-modeling.html#cb163-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> oldmort01) </span>
<span id="cb163-3"><a href="cox-proportional-hazard-modeling.html#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="cox-proportional-hazard-modeling.html#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(oldmort_cox), <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Covariate             Mean       Coef     Rel.Risk   S.E.    LR p
## sex                                                         0.0001 
##             male      0.406     0         1 (reference)
##           female      0.594    -0.185     0.831     0.046
## region                                                      0.0013 
##             town      0.111     0         1 (reference)
##         industry      0.326     0.225     1.252     0.087
##            rural      0.563     0.069     1.071     0.087
## imr.birth            15.162     0.005     1.005     0.007   0.5009 
## 
## Events                    1971 
## Total time at risk         37824 
## Max. log. likelihood      -13563 
## LR test statistic         31.41 
## Degrees of freedom        4 
## Overall p-value           2.52611e-06</code></pre>
<p>The same results can be obtained by using <code>coxph</code> from the <code>survival</code> package.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="cox-proportional-hazard-modeling.html#cb165-1" aria-hidden="true" tabindex="-1"></a>oldmort_cox <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> sex <span class="sc">+</span> region <span class="sc">+</span> imr.birth, </span>
<span id="cb165-2"><a href="cox-proportional-hazard-modeling.html#cb165-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> oldmort01) </span>
<span id="cb165-3"><a href="cox-proportional-hazard-modeling.html#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="cox-proportional-hazard-modeling.html#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(oldmort_cox), <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(enter, exit, event) ~ sex + region + imr.birth, 
##     data = oldmort01)
## 
##   n= 6495, number of events= 1971 
## 
##                     coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
## sexfemale      -0.185247  0.830899  0.045913 -4.035 5.47e-05 ***
## regionindustry  0.224903  1.252201  0.087093  2.582  0.00981 ** 
## regionrural     0.069031  1.071470  0.086627  0.797  0.42552    
## imr.birth       0.004548  1.004558  0.006742  0.675  0.49994    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##                exp(coef) exp(-coef) lower .95 upper .95
## sexfemale         0.8309     1.2035    0.7594    0.9091
## regionindustry    1.2522     0.7986    1.0557    1.4853
## regionrural       1.0715     0.9333    0.9042    1.2697
## imr.birth         1.0046     0.9955    0.9914    1.0179
## 
## Concordance= 0.545  (se = 0.008 )
## Likelihood ratio test= 31.41  on 4 df,   p=3e-06
## Wald test            = 31.7  on 4 df,   p=2e-06
## Score (logrank) test = 31.8  on 4 df,   p=2e-06</code></pre>
<p>We would prefer to have <span class="math inline">\(HR &gt; 1\)</span> than <span class="math inline">\(HR &lt; 1\)</span> to ease interpretation.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="cox-proportional-hazard-modeling.html#cb167-1" aria-hidden="true" tabindex="-1"></a>oldmort01<span class="sc">$</span>male <span class="ot">&lt;-</span> <span class="fu">relevel</span>(oldmort01<span class="sc">$</span>sex, <span class="at">ref =</span> <span class="st">&quot;female&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="cox-proportional-hazard-modeling.html#cb168-1" aria-hidden="true" tabindex="-1"></a>oldmort_cox <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> male <span class="sc">+</span> region <span class="sc">+</span> imr.birth, </span>
<span id="cb168-2"><a href="cox-proportional-hazard-modeling.html#cb168-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> oldmort01) </span>
<span id="cb168-3"><a href="cox-proportional-hazard-modeling.html#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="cox-proportional-hazard-modeling.html#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(oldmort_cox), <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(enter, exit, event) ~ male + region + imr.birth, 
##     data = oldmort01)
## 
##   n= 6495, number of events= 1971 
## 
##                    coef exp(coef) se(coef)     z Pr(&gt;|z|)    
## malemale       0.185247  1.203516 0.045913 4.035 5.47e-05 ***
## regionindustry 0.224903  1.252201 0.087093 2.582  0.00981 ** 
## regionrural    0.069031  1.071470 0.086627 0.797  0.42552    
## imr.birth      0.004548  1.004558 0.006742 0.675  0.49994    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##                exp(coef) exp(-coef) lower .95 upper .95
## malemale           1.204     0.8309    1.0999     1.317
## regionindustry     1.252     0.7986    1.0557     1.485
## regionrural        1.071     0.9333    0.9042     1.270
## imr.birth          1.005     0.9955    0.9914     1.018
## 
## Concordance= 0.545  (se = 0.008 )
## Likelihood ratio test= 31.41  on 4 df,   p=3e-06
## Wald test            = 31.7  on 4 df,   p=2e-06
## Score (logrank) test = 31.8  on 4 df,   p=2e-06</code></pre>
<p>The following code will extract coefficients and model fit statistics.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="cox-proportional-hazard-modeling.html#cb170-1" aria-hidden="true" tabindex="-1"></a>cox_coef <span class="ot">&lt;-</span> <span class="fu">summary</span>(oldmort_cox)<span class="sc">$</span>coefficients</span>
<span id="cb170-2"><a href="cox-proportional-hazard-modeling.html#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="cox-proportional-hazard-modeling.html#cb170-3" aria-hidden="true" tabindex="-1"></a>cox_fit <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb170-4"><a href="cox-proportional-hazard-modeling.html#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Wald&quot;</span> <span class="ot">=</span> oldmort_cox<span class="sc">$</span>wald.test,</span>
<span id="cb170-5"><a href="cox-proportional-hazard-modeling.html#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Score(log_rank)&quot;</span> <span class="ot">=</span> oldmort_cox<span class="sc">$</span>score</span>
<span id="cb170-6"><a href="cox-proportional-hazard-modeling.html#cb170-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="cox-proportional-hazard-modeling.html#cb171-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cox_coef, <span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
coef
</th>
<th style="text-align:right;">
exp(coef)
</th>
<th style="text-align:right;">
se(coef)
</th>
<th style="text-align:right;">
z
</th>
<th style="text-align:right;">
Pr(&gt;|z|)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
malemale
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
1.20
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
4.03
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
regionindustry
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
1.25
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
2.58
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
regionrural
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
1.07
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:left;">
imr.birth
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.50
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="cox-proportional-hazard-modeling.html#cb172-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cox_fit, <span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
Wald
</td>
<td style="text-align:right;">
31.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Score(log_rank)
</td>
<td style="text-align:right;">
31.8
</td>
</tr>
</tbody>
</table>
</div>
<div id="model-1-no-covariates" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Model 1: No covariates<a href="cox-proportional-hazard-modeling.html#model-1-no-covariates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="cox-proportional-hazard-modeling.html#cb173-1" aria-hidden="true" tabindex="-1"></a>oldmort_cox01 <span class="ot">&lt;-</span> <span class="fu">coxreg</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> sex , </span>
<span id="cb173-2"><a href="cox-proportional-hazard-modeling.html#cb173-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> oldmort01) </span>
<span id="cb173-3"><a href="cox-proportional-hazard-modeling.html#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="cox-proportional-hazard-modeling.html#cb173-4" aria-hidden="true" tabindex="-1"></a>cox_coef01 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">summary</span>(oldmort_cox01)<span class="sc">$</span>coefficients)</span>
<span id="cb173-5"><a href="cox-proportional-hazard-modeling.html#cb173-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-6"><a href="cox-proportional-hazard-modeling.html#cb173-6" aria-hidden="true" tabindex="-1"></a>cox_fit01 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb173-7"><a href="cox-proportional-hazard-modeling.html#cb173-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Wald&quot;</span> <span class="ot">=</span> oldmort_cox01<span class="sc">$</span>wald.test,</span>
<span id="cb173-8"><a href="cox-proportional-hazard-modeling.html#cb173-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Score(log_rank)&quot;</span> <span class="ot">=</span> oldmort_cox01<span class="sc">$</span>score</span>
<span id="cb173-9"><a href="cox-proportional-hazard-modeling.html#cb173-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="model-2-categorical-covariate-region" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Model 2: Categorical covariate: region<a href="cox-proportional-hazard-modeling.html#model-2-categorical-covariate-region" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="cox-proportional-hazard-modeling.html#cb174-1" aria-hidden="true" tabindex="-1"></a>oldmort_cox02 <span class="ot">&lt;-</span> <span class="fu">coxreg</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> sex <span class="sc">+</span> region , </span>
<span id="cb174-2"><a href="cox-proportional-hazard-modeling.html#cb174-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> oldmort01) </span>
<span id="cb174-3"><a href="cox-proportional-hazard-modeling.html#cb174-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-4"><a href="cox-proportional-hazard-modeling.html#cb174-4" aria-hidden="true" tabindex="-1"></a>cox_coef02 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">summary</span>(oldmort_cox02)<span class="sc">$</span>coefficients)</span>
<span id="cb174-5"><a href="cox-proportional-hazard-modeling.html#cb174-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-6"><a href="cox-proportional-hazard-modeling.html#cb174-6" aria-hidden="true" tabindex="-1"></a>cox_fit02 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb174-7"><a href="cox-proportional-hazard-modeling.html#cb174-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Wald&quot;</span> <span class="ot">=</span> oldmort_cox02<span class="sc">$</span>wald.test,</span>
<span id="cb174-8"><a href="cox-proportional-hazard-modeling.html#cb174-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Score(log_rank)&quot;</span> <span class="ot">=</span> oldmort_cox02<span class="sc">$</span>score</span>
<span id="cb174-9"><a href="cox-proportional-hazard-modeling.html#cb174-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="model-3-continuous-covariate-imr.birth" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Model 3: Continuous covariate: imr.birth<a href="cox-proportional-hazard-modeling.html#model-3-continuous-covariate-imr.birth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="cox-proportional-hazard-modeling.html#cb175-1" aria-hidden="true" tabindex="-1"></a>oldmort_cox03 <span class="ot">&lt;-</span> <span class="fu">coxreg</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> sex <span class="sc">+</span> region <span class="sc">+</span> imr.birth, </span>
<span id="cb175-2"><a href="cox-proportional-hazard-modeling.html#cb175-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> oldmort01) </span>
<span id="cb175-3"><a href="cox-proportional-hazard-modeling.html#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="cox-proportional-hazard-modeling.html#cb175-4" aria-hidden="true" tabindex="-1"></a>cox_coef03 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">summary</span>(oldmort_cox03)<span class="sc">$</span>coefficients)</span>
<span id="cb175-5"><a href="cox-proportional-hazard-modeling.html#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="cox-proportional-hazard-modeling.html#cb175-6" aria-hidden="true" tabindex="-1"></a>cox_fit03 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb175-7"><a href="cox-proportional-hazard-modeling.html#cb175-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Wald&quot;</span> <span class="ot">=</span> oldmort_cox03<span class="sc">$</span>wald.test,</span>
<span id="cb175-8"><a href="cox-proportional-hazard-modeling.html#cb175-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Score(log_rank)&quot;</span> <span class="ot">=</span> oldmort_cox03<span class="sc">$</span>score</span>
<span id="cb175-9"><a href="cox-proportional-hazard-modeling.html#cb175-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="cox-proportional-hazard-modeling.html#cb176-1" aria-hidden="true" tabindex="-1"></a>cox_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">setDT</span>(cox_coef01), <span class="fu">setDT</span>(cox_coef02), <span class="fu">setDT</span>(cox_coef03))</span></code></pre></div>
<pre><code>## Warning in as.data.table.list(x, keep.rownames = keep.rownames, check.names =
## check.names, : Item 2 has 3 rows but longest item has 4; recycled with
## remainder.</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="cox-proportional-hazard-modeling.html#cb178-1" aria-hidden="true" tabindex="-1"></a>cox_fit <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cox_fit01, cox_fit02, cox_fit03)</span>
<span id="cb178-2"><a href="cox-proportional-hazard-modeling.html#cb178-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-3"><a href="cox-proportional-hazard-modeling.html#cb178-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cox_coef, <span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
coef
</th>
<th style="text-align:right;">
exp(coef)
</th>
<th style="text-align:right;">
se(coef)
</th>
<th style="text-align:right;">
z
</th>
<th style="text-align:right;">
Wald p
</th>
<th style="text-align:right;">
coef
</th>
<th style="text-align:right;">
exp(coef)
</th>
<th style="text-align:right;">
se(coef)
</th>
<th style="text-align:right;">
z
</th>
<th style="text-align:right;">
Wald p
</th>
<th style="text-align:right;">
coef
</th>
<th style="text-align:right;">
exp(coef)
</th>
<th style="text-align:right;">
se(coef)
</th>
<th style="text-align:right;">
z
</th>
<th style="text-align:right;">
Wald p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-4.23
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-4.07
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-4.03
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-4.23
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
1.24
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
2.50
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
1.25
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
2.58
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-4.23
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
1.05
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
1.07
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-4.23
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-4.07
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.50
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="cox-proportional-hazard-modeling.html#cb179-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cox_fit, <span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
Score(log_rank)
</td>
<td style="text-align:right;">
17.96
</td>
<td style="text-align:right;">
31.34
</td>
<td style="text-align:right;">
31.8
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="cox-proportional-hazard-modeling.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fcox_coef &lt;- flextable(head(cox_coef))</span></span></code></pre></div>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="cox-proportional-hazard-modeling.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fcox_coef &lt;- flextable(head(cox_coef))</span></span>
<span id="cb181-2"><a href="cox-proportional-hazard-modeling.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co">#fcox_coef &lt;- add_body_row(</span></span>
<span id="cb181-3"><a href="cox-proportional-hazard-modeling.html#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  fcox_coef,</span></span>
<span id="cb181-4"><a href="cox-proportional-hazard-modeling.html#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  values = c(&quot;&quot;, &quot;Model 1&quot;, &quot;Model 2&quot;, &quot;Model 3&quot;),</span></span>
<span id="cb181-5"><a href="cox-proportional-hazard-modeling.html#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  colwidths = c(1, 3, 3, 3), top = TRUE</span></span>
<span id="cb181-6"><a href="cox-proportional-hazard-modeling.html#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb181-7"><a href="cox-proportional-hazard-modeling.html#cb181-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-8"><a href="cox-proportional-hazard-modeling.html#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="co">#fcox_coef</span></span></code></pre></div>
</div>
</div>
<div id="interpretation-2" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Interpretation<a href="cox-proportional-hazard-modeling.html#interpretation-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Comparisons between the crude model (i.e., no confounders) and adjusted models
<ul>
<li>Often used to assess if confounding effect exists</li>
<li>Report both even if there is no difference of the model fits for crude and adjusted models</li>
<li>test statistics: difference of -2LL / difference of d.f.s, under <span class="math inline">\(\chi^2\)</span> distributions</li>
</ul></li>
<li>First, let’s examine the model fit statistics.
<ul>
<li>Global statistical significance of the model: The output gives p-values for three alternative tests for overall significance of the model: The likelihood-ratio test, Wald test, and score logrank statistics. These three methods are asymptotically equivalent. For large enough <span class="math inline">\(N\)</span>, they will give similar results. For small <span class="math inline">\(N\)</span>, they may differ somewhat. The Likelihood ratio test has better behavior for small sample sizes, so it is generally preferred.
<ul>
<li>Wald statistics
<ul>
<li><span class="math inline">\(z = \frac{coef}{se(coef)}\)</span> is normally distributed</li>
</ul></li>
<li>Likelihood ratio (LR) statistics
<ul>
<li>-2 Log likelihood (-2LL)</li>
<li>“In general, the LR and Wald statistics may not give exactly the same answer. Statisticians have shown that of the two test procedures, the LR statistic has better statistical properties, so when in doubt, you should use the LR test.”(Kleinbaum DG, Klein M. Survival Analysis. Springer New York; 2012. <a href="doi:10.1007/978-1-4419-6646-9" class="uri">doi:10.1007/978-1-4419-6646-9</a>)</li>
</ul></li>
<li>Score (logrank) test</li>
<li>Concordance ()</li>
</ul></li>
</ul></li>
<li>Now, let’s examine coefficients.
<ul>
<li>Note that there is no <span class="math inline">\(\beta_0\)</span> term</li>
<li>coef: log(Hazard Ratio): A positive sign means that the hazard (risk of death) is higher, and thus the prognosis worse, for subjects with higher values of that variable. For the 0 and 1 variable, the Cox model gives the hazard ratio (HR) for the second group relative to the first group.</li>
<li>exp(coef): Hazard ratio (HR) (<span class="math inline">\(exp(0.1978)=1.2187\)</span>), the hazard for the test group is 1.2 times the hazard for the standard group.</li>
<li>As other regression outputs, we have point estimates, <em>se</em>s, <span class="math inline">\(p\)</span>-values, and confidence intervals.</li>
<li>Statistical significance: The column marked “<span class="math inline">\(z\)</span>” gives the Wald statistic value. It corresponds to the ratio of each regression coefficient to its standard error (<span class="math inline">\(z\)</span> = coef/se(coef)). The wald statistic evaluates, whether the beta (<span class="math inline">\(\beta\)</span>) coefficient of a given variable is statistically significantly different from 0.</li>
<li><span class="math inline">\(p\)</span>-value or CI? (Greenland, S., Senn, S.J., Rothman, K.J. et al. Statistical tests, P values, confidence intervals, and power: a guide to misinterpretations. Eur J Epidemiol 31, 337–350 (2016). <a href="https://doi.org/10.1007/s10654-016-0149-3" class="uri">https://doi.org/10.1007/s10654-016-0149-3</a>)</li>
</ul></li>
</ul>
</div>
<div id="proportional-hazard-ph-assumption" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Proportional hazard (PH) assumption<a href="cox-proportional-hazard-modeling.html#proportional-hazard-ph-assumption" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Mathematical expression<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></li>
</ul>
<p><span class="math display">\[ h_x(t) = \phi^x h_o(t),\;\; t&gt;0,\;\;  x=0,1,\;\;  \phi&gt;0 \]</span></p>
<p>when <span class="math inline">\(x=0\)</span>, <span class="math inline">\(h_0(t) = h_0(t)\)</span> and when <span class="math inline">\(x=1\)</span>, <span class="math inline">\(h_0(t) = \phi h_0(t)\)</span>
When <span class="math inline">\(\beta = \log(\phi)\)</span>,
<span class="math display">\[ h_x(t) = h(t; x) = e^{\beta x} h_o(t),\;\; t&gt;0,\;\;  x=0,1,\;\;  -\infty &lt; \beta &lt; \infty \]</span></p>
<p>For multiple groups ($= (_1, _2, , _k) $),
<span class="math display">\[ h_x(t) = h(t; x) = e^{x_1 \beta_1 + x_2 + \beta_2 + \cdots + x_k \beta_k} h_o(t) = h_0 (t)e^{x \beta},\;\; t&gt;0,\;\;  x=0,1,\;\;  -\infty &lt; \beta &lt; \infty \]</span></p>
<ul>
<li><p><span class="math inline">\(h_0 (t)\)</span>: <strong>baseline hazard</strong> is a function of <span class="math inline">\(t\)</span> but not <span class="math inline">\(X\)</span>’s</p>
<ul>
<li>When all the <span class="math inline">\(X\)</span>’s are equal to 0, than the formula reduces to the baseline hazard function, <span class="math inline">\(h_0 (t)\)</span> as <span class="math inline">\(e^0 = 1\)</span></li>
<li>When no <span class="math inline">\(X\)</span>’s are in the model, than the formula reduces to the baseline hazard function, <span class="math inline">\(h_0 (t)\)</span>.</li>
</ul></li>
<li><p><span class="math inline">\(exp(\sum_{i=1}^p \beta_i X_i)\)</span>: the exponential component is a function of <span class="math inline">\(X\)</span>’s but not <span class="math inline">\(t\)</span> (i.e., <span class="math inline">\(X\)</span>’s are <strong>time-independent</strong> variables)</p></li>
<li><p>A time-independent variable is defined to be any variable whose value for a given individual does not change over time. (e.g., sex, race/ethnicity)</p></li>
<li><p>It may be appropriate to treat Age or Height as time-independent in the analysis if their values <strong>do not change much over time</strong> or if <strong>the effect of such variables on survival risk depends essentially on the value at only one measurement.</strong></p></li>
<li><p>Recall that
<span class="math display">\[\hat{HR} = \frac{\hat{h} (t, X^*)}{\hat{h} (t, X)} = \frac{h_0 (t) \exp(\sum_{i=1}^p \beta_i X_i^*)}{h_0 (t) \exp(\sum_{i=1}^p \beta_i X_i)} = \frac{\exp(\sum_{i=1}^p \beta_i X_i^*)}{\exp(\sum_{i=1}^p \beta_i X_i)} = \exp[{\sum_{i=1}^p \hat{\beta_i}(X_i^* - X_i)}]\]</span></p></li>
<li><p>Notice that the baseline hazard function <span class="math inline">\(h_0 (t)\)</span> appears in both the numerator and denominator of the hazard ratio and cancels out of the formula.</p></li>
<li><p>The final expression for the hazard ratio therefore involves the estimated coefficients <span class="math inline">\(\hat{\beta_i}\)</span> and the values of <span class="math inline">\(X^*\)</span> and <span class="math inline">\(X\)</span> for each variable. However, because the baseline hazard has canceled out, the final expression does not involve time <span class="math inline">\(t\)</span>.</p></li>
<li><p>Thus, once the model is fitted and the values for <span class="math inline">\(X^*\)</span> and <span class="math inline">\(X\)</span> are specified, , which does not depend on time <span class="math inline">\(t\)</span>:</p></li>
</ul>
<p><span class="math display">\[ \hat{HR} = \frac{\hat{h} (t, X^*)}{\hat{h} (t, X)} = exp[{\sum_{i=1}^p \hat{\beta_i}(X_i^* - X_i)}] = \theta\;\; \text{therefore,} \hat{h} (t, X^*) = \hat{\theta}\hat{h} (t, X)\]</span>
-
- In the Cox PH model with 0 and 1 for {X_1}, <span class="math inline">\(\hat{\theta}=e^{\hat{\beta}}\)</span>
- When the PH assumption is in appropriate (e.g., the hazards cross), a Cox PH model is inappropriate and alternative model (e.g., extended Cox model) should be used</p>
</div>
<div id="extended-cox-model" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Extended Cox model<a href="cox-proportional-hazard-modeling.html#extended-cox-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>It is possible to consider <span class="math inline">\(X\)</span>’s which do involve <span class="math inline">\(t\)</span>, so that <span class="math inline">\(X\)</span>s are called <strong>time-dependent</strong> variables.</li>
<li>The extended Cox model no longer satisfies the proportional hazard assumption.</li>
</ul>
</div>
<div id="evaluating-the-proportional-hazard-ph-assumption" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Evaluating the Proportional hazard (PH) assumption<a href="cox-proportional-hazard-modeling.html#evaluating-the-proportional-hazard-ph-assumption" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Cox PH model assumes that the hazard ratio comparing any two specifications of predictors is constant over time. Equivalently, this means that the hazard for one individual is proportional to the hazard for any other individual, where the proportionality constant is
independent of time.</p>
<p>The PH assumption is not met if the graph of the hazards cross for two or more categories of a predictor of interest. However, even if the hazard functions do not cross, it is possible that the PH assumption is not met. Thus, rather than checking for crossing hazards, we must use other approaches to evaluate the reasonableness of the PH assumption.</p>
<div id="graphical-evaluation" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Graphical evaluation<a href="cox-proportional-hazard-modeling.html#graphical-evaluation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Comparing estimated –ln(–ln) survivor curves over different (combinations of) categories of variables
<ul>
<li><ol style="list-style-type: decimal">
<li>assessing the PH assumption for variables one-at-a-time, or 2) assessing the PH assumption after adjusting for other variables.</li>
</ol></li>
<li>Parallel curves, say comparing males with females, indicate that the PH assumption is satisfied</li>
<li>A log–log survival curve is simply a transformation of an estimated survival curve that results from taking the natural log of an estimated survival probability . Mathematically, we write a log–log curve as <span class="math inline">\(-ln(-ln \hat{S})\)</span>. Note that the log of a probability such as <span class="math inline">\(\hat{S}\)</span> is always a negative number. Because we can only take logs of positive numbers, we need to negate the first log before taking the second log. The value for <span class="math inline">\(-ln(-ln \hat{S})\)</span> may be positive or negative, either of which is acceptable</li>
<li>by definition, <span class="math inline">\(-ln(-ln \hat{S})= -ln (\int_0^t h(u)du)\)</span></li>
<li>The scale of an estimated survival curve (<span class="math inline">\(\hat{S}\)</span>) ranges between 0 and 1, whereas the corresponding scale for a <span class="math inline">\(-ln(-ln \hat{S})\)</span> ranges between <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(+\infty\)</span>
<ul>
<li>By empirical plots, we mean that do not assume an underlying Cox model. Alternatively, one could plot .</li>
<li>If observed and predicted curves are “visually” parallel, then the PH assumption is reasonable.</li>
</ul></li>
<li>How much parallel is parallel?
<ul>
<li>Too subjective decision: assume PH is OK unless strong evidence of non-parallelism</li>
<li>many categories data: different categorizations may give different graphical pictures</li>
<li>Assessing the PH assumption after adjusting for other variables: rather than using Kaplan–Meier curves, make a comparison using adjusted log–log survival curves under the PH assumption for one predictor adjusted for other predictors</li>
</ul></li>
</ul></li>
<li>Comparing observed with predicted survivor curves
<ul>
<li>If for each category of the predictor being assessed, the observed and expected plots are “close” to one another, we then can conclude that the PH assumption is satisfied.</li>
<li>“how close is close?”</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="cox-proportional-hazard-modeling.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb182-2"><a href="cox-proportional-hazard-modeling.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> male, <span class="at">data =</span> oldmort01),</span>
<span id="cb182-3"><a href="cox-proportional-hazard-modeling.html#cb182-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb182-4"><a href="cox-proportional-hazard-modeling.html#cb182-4" aria-hidden="true" tabindex="-1"></a>     , <span class="at">fun =</span> <span class="st">&quot;cloglog&quot;</span></span>
<span id="cb182-5"><a href="cox-proportional-hazard-modeling.html#cb182-5" aria-hidden="true" tabindex="-1"></a>     , <span class="at">xlab =</span> <span class="st">&quot;log(time)&quot;</span></span>
<span id="cb182-6"><a href="cox-proportional-hazard-modeling.html#cb182-6" aria-hidden="true" tabindex="-1"></a>     , <span class="at">ylab =</span> <span class="st">&quot;log-log(survival)&quot;</span></span>
<span id="cb182-7"><a href="cox-proportional-hazard-modeling.html#cb182-7" aria-hidden="true" tabindex="-1"></a>     , <span class="at">main =</span> <span class="st">&quot;Sex&quot;</span>)</span>
<span id="cb182-8"><a href="cox-proportional-hazard-modeling.html#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> civ, <span class="at">data =</span> oldmort01),</span>
<span id="cb182-9"><a href="cox-proportional-hazard-modeling.html#cb182-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb182-10"><a href="cox-proportional-hazard-modeling.html#cb182-10" aria-hidden="true" tabindex="-1"></a>     , <span class="at">fun =</span> <span class="st">&quot;cloglog&quot;</span></span>
<span id="cb182-11"><a href="cox-proportional-hazard-modeling.html#cb182-11" aria-hidden="true" tabindex="-1"></a>     , <span class="at">xlab =</span> <span class="st">&quot;log(time)&quot;</span></span>
<span id="cb182-12"><a href="cox-proportional-hazard-modeling.html#cb182-12" aria-hidden="true" tabindex="-1"></a>     , <span class="at">ylab =</span> <span class="st">&quot;log-log(survival)&quot;</span></span>
<span id="cb182-13"><a href="cox-proportional-hazard-modeling.html#cb182-13" aria-hidden="true" tabindex="-1"></a>     , <span class="at">main =</span> <span class="st">&quot;CIV&quot;</span>)</span>
<span id="cb182-14"><a href="cox-proportional-hazard-modeling.html#cb182-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> region, <span class="at">data =</span> oldmort01),</span>
<span id="cb182-15"><a href="cox-proportional-hazard-modeling.html#cb182-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb182-16"><a href="cox-proportional-hazard-modeling.html#cb182-16" aria-hidden="true" tabindex="-1"></a>     , <span class="at">fun =</span> <span class="st">&quot;cloglog&quot;</span></span>
<span id="cb182-17"><a href="cox-proportional-hazard-modeling.html#cb182-17" aria-hidden="true" tabindex="-1"></a>     , <span class="at">xlab =</span> <span class="st">&quot;log(time)&quot;</span></span>
<span id="cb182-18"><a href="cox-proportional-hazard-modeling.html#cb182-18" aria-hidden="true" tabindex="-1"></a>     , <span class="at">ylab =</span> <span class="st">&quot;log-log(survival)&quot;</span></span>
<span id="cb182-19"><a href="cox-proportional-hazard-modeling.html#cb182-19" aria-hidden="true" tabindex="-1"></a>     , <span class="at">main =</span> <span class="st">&quot;Region&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="cox-proportional-hazard-modeling.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb183-2"><a href="cox-proportional-hazard-modeling.html#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> sex, <span class="at">data =</span> child),</span>
<span id="cb183-3"><a href="cox-proportional-hazard-modeling.html#cb183-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb183-4"><a href="cox-proportional-hazard-modeling.html#cb183-4" aria-hidden="true" tabindex="-1"></a>     , <span class="at">fun =</span> <span class="st">&quot;cloglog&quot;</span></span>
<span id="cb183-5"><a href="cox-proportional-hazard-modeling.html#cb183-5" aria-hidden="true" tabindex="-1"></a>     , <span class="at">xlab =</span> <span class="st">&quot;log(time)&quot;</span></span>
<span id="cb183-6"><a href="cox-proportional-hazard-modeling.html#cb183-6" aria-hidden="true" tabindex="-1"></a>     , <span class="at">ylab =</span> <span class="st">&quot;log-log(survival)&quot;</span></span>
<span id="cb183-7"><a href="cox-proportional-hazard-modeling.html#cb183-7" aria-hidden="true" tabindex="-1"></a>     , <span class="at">main =</span> <span class="st">&quot;Sex&quot;</span>)</span>
<span id="cb183-8"><a href="cox-proportional-hazard-modeling.html#cb183-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> socBranch, <span class="at">data =</span> child),</span>
<span id="cb183-9"><a href="cox-proportional-hazard-modeling.html#cb183-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb183-10"><a href="cox-proportional-hazard-modeling.html#cb183-10" aria-hidden="true" tabindex="-1"></a>     , <span class="at">fun =</span> <span class="st">&quot;cloglog&quot;</span></span>
<span id="cb183-11"><a href="cox-proportional-hazard-modeling.html#cb183-11" aria-hidden="true" tabindex="-1"></a>     , <span class="at">xlab =</span> <span class="st">&quot;log(time)&quot;</span></span>
<span id="cb183-12"><a href="cox-proportional-hazard-modeling.html#cb183-12" aria-hidden="true" tabindex="-1"></a>     , <span class="at">ylab =</span> <span class="st">&quot;log-log(survival)&quot;</span></span>
<span id="cb183-13"><a href="cox-proportional-hazard-modeling.html#cb183-13" aria-hidden="true" tabindex="-1"></a>     , <span class="at">main =</span> <span class="st">&quot;Soc Branch&quot;</span>)</span>
<span id="cb183-14"><a href="cox-proportional-hazard-modeling.html#cb183-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> illeg, <span class="at">data =</span> child),</span>
<span id="cb183-15"><a href="cox-proportional-hazard-modeling.html#cb183-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb183-16"><a href="cox-proportional-hazard-modeling.html#cb183-16" aria-hidden="true" tabindex="-1"></a>     , <span class="at">fun =</span> <span class="st">&quot;cloglog&quot;</span></span>
<span id="cb183-17"><a href="cox-proportional-hazard-modeling.html#cb183-17" aria-hidden="true" tabindex="-1"></a>     , <span class="at">xlab =</span> <span class="st">&quot;log(time)&quot;</span></span>
<span id="cb183-18"><a href="cox-proportional-hazard-modeling.html#cb183-18" aria-hidden="true" tabindex="-1"></a>     , <span class="at">ylab =</span> <span class="st">&quot;log-log(survival)&quot;</span></span>
<span id="cb183-19"><a href="cox-proportional-hazard-modeling.html#cb183-19" aria-hidden="true" tabindex="-1"></a>     , <span class="at">main =</span> <span class="st">&quot;Illegal&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
</div>
<div id="goodness-of-fit-gof" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Goodness-of-fit (GOF)<a href="cox-proportional-hazard-modeling.html#goodness-of-fit-gof" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>A nonsignificant (i.e., large) <span class="math inline">\(p\)</span>-value from large sample <span class="math inline">\(z\)</span> or <span class="math inline">\(\chi^2\)</span> statistics , say greater than 0.10, suggests that the PH assumption is reasonable, whereas a small <span class="math inline">\(p\)</span>-value, say less than 0.05, suggests that the variable being tested does not satisfy this assumption.</li>
<li>More objective decision using a statistical test than graphical evaluation</li>
<li><strong>Schoenfeld residuals</strong>
<ul>
<li>The idea behind the statistical test is that if the PH assumption holds for a particular covariate then the Schoenfeld residuals for that covariate will not be related to survival time.</li>
<li>For each predictor in the model, Schoenfeld residuals are defined for every subject who has an event. For example, consider a Cox PH model with three predictors: <code>sex</code>, <code>region</code>, and <code>imr.birth</code>. Then there are three Schoenfeld residuals defined for each subject who has an event, one for each of the three predictors.</li>
<li>Three step process
<ul>
<li>Step 1. Run a Cox PH model and obtain Schoenfeld residuals for each predictor.</li>
<li>Step 2. Create a variable that ranks the order of failures. The subject who has the first (earliest) event gets a value of 1, the next gets a value of 2, and so on.</li>
<li>Step 3. Test the correlation between the variables created in the first and second steps. The null hypothesis is that the correlation between the Schoenfeld residuals and ranked failure time is zero</li>
<li><strong>Rejection of the null hypothesis leads to a conclusion that the PH assumption is violated</strong></li>
<li>However, 1) a <span class="math inline">\(p\)</span>-value can be driven by sample size; 2) A gross violation of the null assumption may not be statistically significant if the sample is very small; and 3) conversely, a slight violation of the null assumption may be highly significant if the sample is very large.</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="cox-proportional-hazard-modeling.html#cb184-1" aria-hidden="true" tabindex="-1"></a>cox.gof <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> sex <span class="sc">+</span> region <span class="sc">+</span> imr.birth,</span>
<span id="cb184-2"><a href="cox-proportional-hazard-modeling.html#cb184-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> oldmort01)</span>
<span id="cb184-3"><a href="cox-proportional-hazard-modeling.html#cb184-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-4"><a href="cox-proportional-hazard-modeling.html#cb184-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-5"><a href="cox-proportional-hazard-modeling.html#cb184-5" aria-hidden="true" tabindex="-1"></a>res.zph <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(cox.gof, <span class="at">transform =</span> <span class="fu">c</span>(<span class="st">&quot;km&quot;</span>,<span class="st">&quot;rank&quot;</span>,<span class="st">&quot;idenityt&quot;</span>)[<span class="dv">2</span>])</span>
<span id="cb184-6"><a href="cox-proportional-hazard-modeling.html#cb184-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-7"><a href="cox-proportional-hazard-modeling.html#cb184-7" aria-hidden="true" tabindex="-1"></a>res.zph</span></code></pre></div>
<pre><code>##           chisq df      p
## sex        5.25  1 0.0220
## region     9.83  2 0.0073
## imr.birth  6.54  1 0.0105
## GLOBAL    18.96  4 0.0008</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="cox-proportional-hazard-modeling.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.zph)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-104-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-104-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-104-3.png" width="672" /></p>
</div>
<div id="time-dependent-variable-approaches" class="section level3 hasAnchor" number="6.6.3">
<h3><span class="header-section-number">6.6.3</span> Time-dependent variable approaches<a href="cox-proportional-hazard-modeling.html#time-dependent-variable-approaches" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The Cox model is extended to contain product (i.e., interaction) terms involving the time-independent variable being assessed and some function of time. If the coefficient of the product term turns out to be significant, we can conclude that the PH assumption is violated.
<ul>
<li>Using the above one-at-a-time model, we assess the PH assumption by testing for the significance of the product term. The null hypothesis is therefore “d equal to zero.” Note that if the null hypothesis is true, the model reduces to a Cox PH model containing the single variable X. The test can be carried out using .</li>
<li>To assess the PH assumption for several predictors simultaneously, the form of the extended model is</li>
</ul></li>
</ul>
<p><span class="math display">\[h(t,X) =h_0(t) exp\left[\sum_{i=1}^p (\beta_i X_i + \delta_i (X_i \times g_i(t)))\right], \text{ where } g_i(t) \text{ is a function of time for } i^{th} \text{ predictor}\]</span>
- This model contains the predictors being assessed as main effect terms and also as product terms with some function of time. Note that different predictors may require different functions of time; hence, the notation <span class="math inline">\(g_i (t)\)</span> is used to define the time function for the <span class="math inline">\(i^{th}\)</span> predictor
- With the above model, we test for the PH assumption simultaneously by assessing the null hypothesis that all the <span class="math inline">\(\delta_i\)</span> coefficients are equal to zero. This requires a likelihood ratio chi-square statistic with <span class="math inline">\(p\)</span> degrees of freedom, where <span class="math inline">\(p\)</span> denotes the number of predictors being assessed. The LR statistic computes the difference between the log likelihood statistic (i.e., <span class="math inline">\(-2\; ln\; L\)</span>) for the PH model and the log likelihood statistic for the extended Cox model. Note that under the null hypothesis, the model reduces to the Cox PH model.</p>
<ul>
<li>If the above test is found to be significant, then we can conclude that the PH assumption is not satisfied for at least one of the predictors in the model. To determine which predictor(s) do not satisfy the PH assumption, we could proceed by backward elimination of nonsignificant product terms until a final model is attained.<br />
</li>
<li>The primary drawback of the use of an extended Cox model for assessing the PH assumption concerns the choice of the functions <span class="math inline">\(g_i (t)\)</span> for the time-dependent product terms in the model. This choice is typically not clear-cut, and it is possible that different choices, such as <span class="math inline">\(g(t)\)</span> equal to <span class="math inline">\(t\)</span> versus log <span class="math inline">\(t\)</span> versus a heaviside function, may result in different conclusions about whether the PH assumption is satisfied.</li>
</ul>
</div>
<div id="testing-for-influential-observations" class="section level3 hasAnchor" number="6.6.4">
<h3><span class="header-section-number">6.6.4</span> Testing for Influential Observations<a href="cox-proportional-hazard-modeling.html#testing-for-influential-observations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Testing for Influential Observations{}</p></li>
<li><p>To test influential observations or outliers, we can visualize either the deviance residuals or the dfbeta values</p></li>
<li><p>type: the type of residuals to present on Y axis. Allowed values include one of c(“martingale”, “deviance”, “score”, “schoenfeld”, “dfbeta”, “dfbetas”, “scaledsch”, “partial”).</p></li>
<li><p>It’s also possible to check outliers by visualizing the deviance residuals. The deviance residual is a normalized transform of the martingale residual. These residuals should be roughtly symmetrically distributed about zero with a standard deviation of 1.</p>
<ul>
<li>Positive values correspond to individuals that “died too soon” compared to expected survival times.</li>
<li>Negative values correspond to individual that “lived too long”.</li>
<li>Very large or small values are outliers, which are poorly predicted by the model.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="cox-proportional-hazard-modeling.html#cb187-1" aria-hidden="true" tabindex="-1"></a>survminer<span class="sc">::</span><span class="fu">ggcoxdiagnostics</span>(oldmort_cox03, <span class="at">type =</span> <span class="st">&quot;martingale&quot;</span>,</span>
<span id="cb187-2"><a href="cox-proportional-hazard-modeling.html#cb187-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">linear.predictions =</span> <span class="cn">FALSE</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())</span></code></pre></div>
<pre><code>## Warning: `gather_()` was deprecated in tidyr 1.2.0.
## ℹ Please use `gather()` instead.
## ℹ The deprecated feature was likely used in the survminer package.
##   Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="cox-proportional-hazard-modeling.html#cb190-1" aria-hidden="true" tabindex="-1"></a>survminer<span class="sc">::</span><span class="fu">ggcoxdiagnostics</span>(oldmort_cox03, <span class="at">type =</span> <span class="st">&quot;schoenfeld&quot;</span>,</span>
<span id="cb190-2"><a href="cox-proportional-hazard-modeling.html#cb190-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">linear.predictions =</span> <span class="cn">FALSE</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="cox-proportional-hazard-modeling.html#cb192-1" aria-hidden="true" tabindex="-1"></a>survminer<span class="sc">::</span><span class="fu">ggcoxdiagnostics</span>(oldmort_cox03, <span class="at">type =</span> <span class="st">&quot;dfbeta&quot;</span>,</span>
<span id="cb192-2"><a href="cox-proportional-hazard-modeling.html#cb192-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">linear.predictions =</span> <span class="cn">FALSE</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="cox-proportional-hazard-modeling.html#cb194-1" aria-hidden="true" tabindex="-1"></a>survminer<span class="sc">::</span><span class="fu">ggcoxdiagnostics</span>(oldmort_cox03, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>,</span>
<span id="cb194-2"><a href="cox-proportional-hazard-modeling.html#cb194-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">linear.predictions =</span> <span class="cn">FALSE</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
</div>
<div id="testing-for-non-linearlity" class="section level3 hasAnchor" number="6.6.5">
<h3><span class="header-section-number">6.6.5</span> Testing for Non-linearlity<a href="cox-proportional-hazard-modeling.html#testing-for-non-linearlity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Nonlinearity is not an issue for categorical variables, so we only examine plots of martingale residuals and partial residuals against a continuous variable.</li>
<li>Martingale residuals may present any value in the range (<span class="math inline">\(-\infty,\; +1\)</span>):
<ul>
<li>a value of martinguale residuals near 1 represents individuals that “died too soon”,</li>
<li>large negative values correspond to individuals that “lived too long”.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="cox-proportional-hazard-modeling.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoxfunctional</span>(<span class="fu">Surv</span>(enter, exit, event) <span class="sc">~</span> imr.birth <span class="sc">+</span> <span class="fu">log</span>(imr.birth) <span class="sc">+</span> <span class="fu">sqrt</span>(imr.birth), <span class="at">data =</span> oldmort01)</span></code></pre></div>
<pre><code>## Warning: arguments formula is deprecated; will be removed in the next version;
## please use fit instead.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p><a href="http://ehar.se/r/ehar2/proportional-hazards-and-cox-regression.html#cox-regression-models" class="uri">http://ehar.se/r/ehar2/proportional-hazards-and-cox-regression.html#cox-regression-models</a><a href="cox-proportional-hazard-modeling.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="survival-models-specification-estimation-and-interpretation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="accounting-for-heterogeneity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-Survival04.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
